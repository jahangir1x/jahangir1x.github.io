import{disableNewInputTableCreation,disableNewOwnerInfoTableCreation,getLedgers,ownerTableHeads,ownerTableRowOperationButtons}from"./utils.js";const removeLastOwnerTableRow=e=>{var t=document.querySelector("#"+e);let n=t.rows[t.rows.length-1];1!==n.rowIndex&&(n.remove(),n=t.rows[t.rows.length-1],createOperationCell(n,e))},createNewOwnerTableRow=e=>{var t=document.querySelector("#"+e),n=t.rows[t.rows.length-1],n=(n.cells[n.cells.length-1].remove(),t.insertRow());createTableMainData(n,e)},createOwnerInfoTable=()=>{disableNewInputTableCreation(),disableNewOwnerInfoTableCreation(),document.querySelector("#create-table-btn"),Object.keys(getLedgers()).forEach((e,t)=>{var n=document.createElement("table"),t=(document.querySelector("#owner-info-tables-container").appendChild(n),n.classList.add("table","table-bordered","table-hover"),n.id="owner-info-table-"+t,document.createElement("thead")),r=(n.appendChild(t),document.createElement("tr")),t=(r.innerHTML=ownerTableHeads.map(e=>`<th>${e}</th>`).join(""),t.appendChild(r),document.createElement("tbody"));n.appendChild(t);let o=t.insertRow();r=o.insertCell();r.rowSpan=0,r.innerHTML=e.split("|").map(e=>`<span>${e}</span>`).join("<br/>"),o=t.insertRow(),createTableMainData(o,n.id)}),document.querySelector("#owner-info-tables-container").scrollIntoView({behavior:"smooth"})},createTableMainData=(e,t)=>{e.insertCell().innerHTML='<input class="form-control col-1 lowres-input" type="text">',e.insertCell().innerHTML='<input class="form-control col-1 lowres-input" type="text">';const n=e.insertCell();n.innerHTML='<input class="form-control col-1 lowres-input" type="text">',n.querySelector("input").addEventListener("input",()=>handleLandAmountInput(n,e,t)),e.insertCell().innerHTML='<input class="form-control col-1 lowres-input" type="text">',createOperationCell(e,t)},handleLandAmountInput=(e,t,n)=>{var n=document.querySelector("#"+n+" .total-land-application-amount"),r=parseFloat(n.querySelector(".total").textContent);console.log(r);let o="",a=0;for(let e=1;e<t.parentNode.rows.length;e++){var l=parseFloat(t.parentNode.rows[e].cells[2].querySelector("input").value);isNaN(l)||(o+=`<br/><span> - ${l}</span>`,a+=l)}n.innerHTML=`<span class="total">${r}</span>`,n.innerHTML+=o,n.innerHTML+=`<hr><span>${r-a}</span>`},createOperationCell=(e,t)=>{e=e.insertCell();e.innerHTML=ownerTableRowOperationButtons,e.querySelector("#add-new-owner-table-row-btn").addEventListener("click",()=>createNewOwnerTableRow(t)),e.querySelector("#remove-this-owner-table-row-btn").addEventListener("click",()=>removeLastOwnerTableRow(t))};export{removeLastOwnerTableRow,createNewOwnerTableRow,createOwnerInfoTable};