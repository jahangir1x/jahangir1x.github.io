import{recalculateStoredTables,resetActionsState}from"./input_table_operations.js";import{getFractionDigits,getLedgers,populateLedgerMap}from"./utils.js";const moveInputTableToCollection=()=>{var t=document.querySelector("#records-input-table"),e=document.querySelector("#tables-container"),l=(t.id="",t.classList.add("records-input-table"),t.querySelectorAll("input")),o=t.querySelector("#paper-type-option").value,r=t.querySelector("#paper-type-text").value,r="অন্যান্য"===o?r:o;t.querySelector("#paper-type-text").value=r,t.querySelector("#paper-type-option").remove(),t.querySelector("#paper-type-text").style.display="block",l.forEach(function(e){var l=document.createElement("span");l.textContent=e.value,e.parentNode.replaceChild(l,e)});for(let l=2;l<t.rows.length-1;l++){var s=t.rows[l].cells[4].childNodes[1].childNodes[1].textContent,c=t.rows[l].cells[4].childNodes[1].childNodes[5].textContent;let e=t.rows[l].cells[4].childNodes[1].childNodes[9].textContent+`/${c}/`+s;"//"===e&&(e="");var c=t.rows[l].cells[5].childNodes[0].innerHTML,s=t.rows[l].cells[2].innerHTML,n=t.rows[l].cells[3].childNodes[0].innerHTML;t.rows[l].cells[4].innerHTML=`(${n} <i class="fa-solid fa-ellipsis-vertical blue"></i> ${e} <i class="fa-solid fa-ellipsis-vertical blue"></i> ${c}) `+s,t.rows[l].cells[5].remove()}t.rows[0].cells[8].remove(),t.rows[0].cells[7].remove(),t.rows[0].cells[6].innerHTML='(দলিল নং <i class="fa-solid fa-ellipsis-vertical blue"></i> তারিখ <i class="fa-solid fa-ellipsis-vertical blue"></i> রেজি অফিস) <i class="fa-solid fa-ellipsis-vertical blue"></i> দাগে জমি';for(let e=2;e<t.rows.length-1;e++)t.rows[e].cells[3].remove();let a=document.querySelectorAll("#tables-container table");o=r+" | "+t.rows[1].cells[1].childNodes[0].textContent;if(void 0!==getLedgers()[o]){var i=getLedgers()[o],d=i.tableIdx;a[d].rows[1].cells[2].innerHTML+="<br/>"+t.rows[1].cells[2].innerHTML;for(let e=2;e<t.rows.length-1;e++){const f=t.rows[e].cells[0].childNodes[0].textContent;var u,p,w,h,y=i.lands.findIndex(e=>e.landId===f);-1!==y?(u=i.tableIdx,h=a[u].rows[i.lands[y].row].cells[2],w=t.rows[e].cells[2],p=parseFloat(h.childNodes[0].textContent),w=parseFloat(w.childNodes[0].textContent),h.childNodes[0].textContent=(p+w).toFixed(getFractionDigits()),h=i.lands[y].row,void 0!==a[u].rows[h]&&void 0!==a[u].rows[h].cells[0]&&void 0!==a[u].rows[h].cells[0].childNodes[0]&&a[u].rows[h].cells[0].childNodes[0].textContent===f&&(a[u].rows[h].cells[3].innerHTML+="<br/>"+t.rows[e].cells[3].innerHTML)):a[d].insertRow(a[d].rows.length-1).innerHTML=t.rows[e].innerHTML}t.remove()}else e.appendChild(t);if(recalculateStoredTables(),1<(a=document.querySelectorAll("#tables-container table")).length)for(let e=1;e<a.length;e++)a[e].rows[0].style.display="none";(a=document.querySelectorAll("#tables-container table")).forEach(function(e){e.querySelectorAll(".paper-type-cell").forEach(e=>e.style.width="7%"),e.querySelectorAll(".ledger-number-cell").forEach(e=>e.style.width="6%"),e.querySelectorAll(".land-request-amount-cell").forEach(e=>e.style.width="8%"),e.querySelectorAll(".land-number-cell").forEach(e=>e.style.width="9%"),e.querySelectorAll(".land-amount-cell").forEach(e=>e.style.width="8%"),e.querySelectorAll(".application-cell").forEach(e=>e.style.width="12%"),e.querySelectorAll(".reg-date-cell").forEach(e=>e.style.width="100%")}),document.querySelector("#create-owner-info-table-btn").style.display="block",resetColorsForTables(e),resetActionsState(),populateLedgerMap()},resetColorsForTables=e=>{e.childNodes.forEach(function(t){for(let l=1;l<t.rows.length;l++)for(let e=0;e<t.rows[l].cells.length;e++)t.rows[l].cells[e].style.backgroundColor=""})};export{moveInputTableToCollection,resetColorsForTables};